# Interactive Material Lab: 物理ベース弾性体シミュレータ

## 概要

PythonとNumPyのみを用いて実装された、リアルタイム物理シミュレーションのデモプログラムです。
「質量・バネ・ダンパモデル（Mass-Spring-Damper Model）」を用いて、スライムのような粘弾性体から硬い物体まで、多様な物理挙動をインタラクティブに再現します。

## 特徴

* **リアルタイムなパラメータ調整:** 実行中に「剛性（Stiffness）」「減衰（Damping）」「質量（Mass）」を変更し、即座に挙動の変化を確認できます。
* **直感的なインタラクション:** マウスドラッグで物体を引っ張ったり、壁にぶつけたりして「手触り」を確認できます。
* **視覚的なフィードバック:** 物体の硬さに応じて、リアルタイムに色が変化します（緑：スライム状  青：標準  グレー：硬質）。

## 動作環境・インストール方法

### 必要ライブラリ

以下のPythonライブラリが必要です。

* NumPy
* Matplotlib

### 実行方法

```bash
# 1. リポジトリのクローン（またはファイルのダウンロード）
git clone [あなたのリポジトリURL]

# 2. 依存ライブラリのインストール
pip install numpy matplotlib

# 3. プログラムの実行
python physics_lab.py

```

## 操作方法

画面が起動すると、上部にシミュレーション領域、下部に操作パネルが表示されます。

1. **マウス操作:**
* シミュレーション画面内の青い（または緑・グレーの）格子点をクリックしてドラッグすると、物体を引っ張ることができます。


2. **パラメータ調整（スライダー/数値入力）:**
* **Stiffness (剛性):** バネの硬さを変更します。値を下げるとスライムのように垂れ、上げると形状を保ちます。
* **Damping (減衰):** 揺れの収まりやすさを変更します。値を上げると粘り気が増し（水飴状）、下げると弾みます（ゴムボール状）。
* **Mass (質量):** 質点の重さを変更します。重力の影響や、ドラッグした際の重み付けが変わります。



## 技術的なこだわり（Implementation Highlights）

### 1. NumPyによるベクトル化演算（Vectorization）

Pythonのforループは低速であるため、物理計算カーネル（`update_physics`）内の演算は徹底してベクトル化を行いました。
特に、各質点に作用する力の集計（アセンブリ）において、FEM（有限要素法）の考え方を応用し、`np.add.at` を用いることで、ループを使わずに高速に力の分配を行っています。

```python
# 作用・反作用の法則に基づく力の分配（コード抜粋）
np.add.at(forces, springs[:, 0], force_mag * direction)
np.add.at(forces, springs[:, 1], -force_mag * direction)

```

### 2. 幾何学的整合性の確保

単純な格子状バネモデルでは、斜め方向（対角線）のバネを適切な長さに設定しないと、初期状態で内部応力が発生し、形状が歪んでしまいます。
本実装では、斜めに接続されるバネに対して  倍の自然長補正を動的に適用することで、構造的な整合性を保っています。

```python
# 対角線バネの自然長補正
current_rest[is_diagonal] *= 1.414 

```

### 3. ゲームフィールの追求（安定性と応答性）

数値積分の安定性を高めるため、描画の1フレーム（約16ms）の間に、物理計算をさらに細かく分割（サブステップ化）して実行しています。
これにより、ユーザーがパラメータを極端な値に変更したり、マウスで激しく操作したりしても、シミュレーションが発散（爆発）しにくい堅牢な設計となっています。

## 物理モデルの解説

本シミュレータは、以下の運動方程式をオイラー法（Euler Integration）を用いて離散化し、解いています。

* **弾性力 ():** フックの法則 () に基づき算出。
* **減衰力 ():** 速度に比例する抵抗力 () を導入し、エネルギーの発散を防いでいます。